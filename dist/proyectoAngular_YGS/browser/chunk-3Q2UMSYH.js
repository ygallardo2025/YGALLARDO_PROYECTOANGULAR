import{a as A,b as _,c as F,d as V,e as R,g as T,h as D,i as j,j as G,k as $,l as q,m as B}from"./chunk-F6YX5B72.js";import{f as k,g as E,h as N,m as I}from"./chunk-VBKEXR47.js";import{$ as p,Aa as C,Cb as S,Ea as P,Ja as v,R as U,V as y,Va as u,Wa as i,Xa as n,Ya as g,a as w,aa as f,db as O,eb as d,fb as m,nb as r,ob as b,q as c,r as h,va as s}from"./chunk-O2KJT2HM.js";var x=class o{constructor(e){this.http=e}apiUrl="https://68a470c4c123272fb9b2b56f.mockapi.io/users";fromApi=e=>({id:Number(e.id),name:e.name,email:e.email,role:e.role??"user",token:""});toApi=e=>({id:String(e.id),name:e.name,email:e.email,role:e.role});getAll(){return this.http.get(this.apiUrl).pipe(h(e=>e.map(this.fromApi)))}add(e){return this.http.post(this.apiUrl,e).pipe(h(this.fromApi))}update(e){return this.http.put(`${this.apiUrl}/${e.id}`,this.toApi(e)).pipe(h(this.fromApi))}delete(e){return this.http.delete(`${this.apiUrl}/${e}`)}static \u0275fac=function(t){return new(t||o)(y(I))};static \u0275prov=U({token:o,factory:o.\u0275fac,providedIn:"root"})};function K(o,e){if(o&1){let t=O();i(0,"tr")(1,"td"),r(2),n(),i(3,"td"),r(4),n(),i(5,"td"),r(6),n(),i(7,"td",7)(8,"button",10),d("click",function(){let l=p(t).$implicit,M=m();return f(M.editUser(l))}),r(9,"Editar"),n(),i(10,"button",11),d("click",function(){let l=p(t).$implicit,M=m();return f(M.remove(l))}),r(11,"Eliminar"),n()()()}if(o&2){let t=e.$implicit;s(2),b(t.name),s(2),b(t.email),s(2),b(t.role)}}function L(o,e){o&1&&(i(0,"div",18)(1,"label",19),r(2,"Contrase\xF1a"),n(),g(3,"input",29),n())}function Q(o,e){if(o&1){let t=O();i(0,"div",12)(1,"div",13)(2,"h5",14),r(3),n(),i(4,"form",15),d("ngSubmit",function(){p(t);let l=m();return f(l.save())}),g(5,"input",16),i(6,"div",17)(7,"div",18)(8,"label",19),r(9,"Nombre"),n(),g(10,"input",20),n(),i(11,"div",18)(12,"label",19),r(13,"Email"),n(),g(14,"input",21),n(),i(15,"div",18)(16,"label",19),r(17,"Rol"),n(),i(18,"select",22)(19,"option",23),r(20,"user"),n(),i(21,"option",24),r(22,"admin"),n()()(),v(23,L,4,0,"div",25),n(),i(24,"div",26)(25,"button",27),r(26,"Guardar"),n(),i(27,"button",28),d("click",function(){p(t);let l=m();return f(l.editing=null)}),r(28,"Cancelar"),n()()()()()}if(o&2){let t=m();s(3),b(t.editing.id===0?"Nuevo usuario":"Editar usuario"),s(),u("formGroup",t.form),s(19),u("ngIf",(t.editing==null?null:t.editing.id)===0)}}var H=class o{constructor(e,t,a){this.svc=e;this.cdr=t;this.fb=a;this.form=this.fb.group({id:[0],name:["",_.required],email:["",[_.required,_.email]],role:["user",_.required],password:[""]})}users=[];editing=null;form;async ngOnInit(){await this.reload()}async reload(){this.users=await c(this.svc.getAll()),this.cdr.detectChanges()}newUser(){this.editing={id:0,name:"",email:"",role:"user",token:""},this.form.reset({id:0,name:"",email:"",role:"user",password:""}),this.cdr.detectChanges()}editUser(e){this.editing=w({},e),this.form.reset({id:e.id,name:e.name,email:e.email,role:e.role,password:""}),this.cdr.detectChanges()}async save(){if(this.form.markAllAsTouched(),this.form.invalid)return;let e=this.form.value;try{if(e.id&&e.id!==0){let t=await c(this.svc.update({id:e.id,name:e.name,email:e.email,role:e.role}));this.users=this.users.map(a=>a.id===t.id?t:a)}else{let t=await c(this.svc.add({name:e.name,email:e.email,role:e.role,password:e.password||void 0}));this.users=[...this.users,t]}}finally{this.editing=null,this.cdr.detectChanges()}}async remove(e){await c(this.svc.delete(e.id)),this.users=this.users.filter(t=>t.id!==e.id),this.cdr.detectChanges()}static \u0275fac=function(t){return new(t||o)(C(x),C(S),C(q))};static \u0275cmp=P({type:o,selectors:[["app-users-manager"]],decls:21,vars:2,consts:[[1,"container","mt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0"],[1,"btn","btn-primary",3,"click"],[1,"table-responsive"],[1,"table","table-striped","table-bordered","table-hover"],[1,"table-primary"],[1,"text-center"],[4,"ngFor","ngForOf"],["class","card mt-4",4,"ngIf"],[1,"btn","btn-sm","btn-primary","me-2",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"card","mt-4"],[1,"card-body"],[1,"card-title"],[3,"ngSubmit","formGroup"],["type","hidden","formControlName","id"],[1,"row","g-3"],[1,"col-md-6"],[1,"form-label"],["formControlName","name",1,"form-control"],["formControlName","email","type","email",1,"form-control"],["formControlName","role",1,"form-select"],["value","user"],["value","admin"],["class","col-md-6",4,"ngIf"],[1,"mt-3"],["type","submit",1,"btn","btn-success","me-2"],["type","button",1,"btn","btn-secondary",3,"click"],["formControlName","password","type","password","placeholder","(solo al crear)",1,"form-control"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"div",1)(2,"h4",2),r(3,"Usuarios"),n(),i(4,"button",3),d("click",function(){return a.newUser()}),r(5,"Nuevo usuario"),n()(),i(6,"div",4)(7,"table",5)(8,"thead",6)(9,"tr")(10,"th"),r(11,"Nombre"),n(),i(12,"th"),r(13,"Email"),n(),i(14,"th"),r(15,"Rol"),n(),i(16,"th",7),r(17,"Acciones"),n()()(),i(18,"tbody"),v(19,K,12,3,"tr",8),n()()(),v(20,Q,29,3,"div",9),n()),t&2&&(s(19),u("ngForOf",a.users),s(),u("ngIf",a.editing))},dependencies:[N,k,E,B,R,G,$,A,j,F,V,T,D],styles:["[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{max-width:1100px}.card[_ngcontent-%COMP%]{border:1px solid #eee;border-radius:14px;box-shadow:0 8px 20px #0000000f}.card-title[_ngcontent-%COMP%]{font-weight:600}.table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;border-radius:12px;overflow:hidden;background-color:#fff;border:1px solid #eee;box-shadow:0 2px 6px #0000000d;font-family:Segoe UI,system-ui,-apple-system,sans-serif}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f7f7f7!important;color:#333;font-weight:600;padding:14px;text-align:center;border-bottom:1px solid #e0e0e0}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:14px;text-align:center;vertical-align:middle;border-bottom:1px solid #f0f0f0}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;transition:background-color .2s ease}.btn[_ngcontent-%COMP%]{border:none;border-radius:8px;padding:6px 14px;font-weight:500}.btn-primary[_ngcontent-%COMP%]{background-color:#2979ff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#1565c0}.btn-danger[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c62828}.btn-success[_ngcontent-%COMP%]{background-color:#2e7d32;color:#fff}.btn-success[_ngcontent-%COMP%]:hover{background-color:#1b5e20}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#565e64}.form-label[_ngcontent-%COMP%]{font-weight:600}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-radius:10px;border:1px solid #e5e7eb;padding:10px 12px;transition:box-shadow .15s ease,border-color .15s ease}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#2979ff;box-shadow:0 0 0 3px #2979ff26}.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545!important;box-shadow:0 0 0 3px #dc354526!important}@media (max-width: 576px){.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{display:block;width:100%;margin:4px 0!important}}"]})};export{H as UsersManagerComponent};
