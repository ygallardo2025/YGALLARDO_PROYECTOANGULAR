import './polyfills.server.mjs';
import{a as me}from"./chunk-YFLMYXEA.mjs";import{a as Z,b as ee,c as te,d as ie,e as oe,f as ne,g as re,h as se,i as ae,j as le,k as ce}from"./chunk-JNRUABQD.mjs";import{a as L}from"./chunk-67SYT7L3.mjs";import{a as U,b as k,c as z,d as J,e as K,g as Q,h as W,l as X,m as Y}from"./chunk-6EN3DMMQ.mjs";import{i as M,j as q,k as v}from"./chunk-2VSVT3VD.mjs";import{$ as C,$a as m,Ab as j,Bb as B,Da as h,Ha as g,I as R,L as A,Ma as p,Oa as x,_ as f,ab as n,bb as r,cb as b,g as V,gb as E,hb as S,jb as T,ka as $,kb as d,lb as u,n as w,o as P,p as N,rb as G,sb as I,tb as s,ub as _,ya as l,zb as H}from"./chunk-U3AQCJB4.mjs";import{a as y,b as O}from"./chunk-T55IDOPT.mjs";function Ce(i,t){i&1&&(n(0,"th",9),s(1,"T\xEDtulo"),r())}function _e(i,t){if(i&1&&(n(0,"td",10),s(1),r()),i&2){let e=t.$implicit;l(),_(e.title)}}function be(i,t){i&1&&(n(0,"th",9),s(1,"Descripci\xF3n"),r())}function ge(i,t){if(i&1&&(n(0,"td",10),s(1),r()),i&2){let e=t.$implicit;l(),_(e.description)}}function ve(i,t){i&1&&(n(0,"th",9),s(1,"Acciones"),r())}function he(i,t){if(i&1){let e=T();E(0),n(1,"button",12),d("click",function(){f(e);let a=u().$implicit,c=u();return C(c.editarCurso(a))}),s(2,"Editar"),r(),n(3,"button",13),d("click",function(){f(e);let a=u().$implicit,c=u();return C(c.eliminarCurso(a))}),s(4,"Eliminar"),r(),S()}}function xe(i,t){i&1&&s(0,"\u2014")}function Ee(i,t){if(i&1&&(n(0,"td",10),p(1,he,5,0,"ng-container",11)(2,xe,1,0,"ng-template",null,0,B),r()),i&2){let e=G(3),o=u();l(),m("ngIf",o.canEdit)("ngIfElse",e)}}function Se(i,t){i&1&&b(0,"tr",14)}function Te(i,t){i&1&&b(0,"tr",15)}var F=class i{courses=[];canEdit=!1;eliminar=new x;editar=new x;displayedColumns=["title","description","actions"];eliminarCurso(t){this.eliminar.emit(t)}editarCurso(t){this.editar.emit(t)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=g({type:i,selectors:[["app-courses-table"]],inputs:{courses:"courses",canEdit:"canEdit"},outputs:{eliminar:"eliminar",editar:"editar"},decls:12,vars:3,consts:[["noActions",""],["mat-table","",1,"mat-elevation-z1",3,"dataSource"],["matColumnDef","title"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","actions"],["mat-header-row","","class","table-primary",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"text-center"],["mat-cell","",1,"text-center"],[4,"ngIf","ngIfElse"],[1,"btn","btn-sm","btn-primary","me-2",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],["mat-header-row","",1,"table-primary"],["mat-row",""]],template:function(e,o){e&1&&(n(0,"table",1),E(1,2),p(2,Ce,2,0,"th",3)(3,_e,2,1,"td",4),S(),E(4,5),p(5,be,2,0,"th",3)(6,ge,2,1,"td",4),S(),E(7,6),p(8,ve,2,0,"th",3)(9,Ee,4,2,"td",4),S(),p(10,Se,1,0,"tr",7)(11,Te,1,0,"tr",8),r()),e&2&&(m("dataSource",o.courses),l(10),m("matHeaderRowDef",o.displayedColumns),l(),m("matRowDefColumns",o.displayedColumns))},dependencies:[v,M,ce,Z,te,re,ie,ee,se,oe,ne,ae,le],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;border-radius:12px;overflow:hidden;background-color:#fff;box-shadow:0 2px 6px #0000000d;font-family:Segoe UI,sans-serif;border:1px solid #eee}th[_ngcontent-%COMP%]{background-color:#f7f7f7;color:#333;font-weight:600;padding:14px;text-align:center;border-bottom:1px solid #e0e0e0}td[_ngcontent-%COMP%]{padding:14px;text-align:center;border-bottom:1px solid #f0f0f0}tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;transition:background-color .2s ease}button[_ngcontent-%COMP%]{border:none;border-radius:6px;padding:6px 14px;font-weight:500}.btn-primary[_ngcontent-%COMP%]{background-color:#2979ff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#1565c0}.btn-danger[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c62828}"],changeDetection:0})};var D=class i{constructor(t){this.fb=t;this.courseForm=this.fb.group({id:[null],title:["",[k.required]],description:["",[k.required]]})}course=null;save=new x;courseForm;ngOnChanges(t){t.course&&this.course&&this.courseForm.reset(this.course)}getErrorMessage(t){let e=this.courseForm.get(t);return!e||!e.errors||!(e.touched||e.dirty)?null:e.errors.required?"Este campo es obligatorio.":null}onSubmit(){if(this.courseForm.markAllAsTouched(),this.courseForm.valid){let t=this.courseForm.value,e=O(y({},t),{id:this.course?.id??t.id??0});this.save.emit(e),this.courseForm.reset()}}onReset(){this.courseForm.reset()}static \u0275fac=function(e){return new(e||i)(h(X))};static \u0275cmp=g({type:i,selectors:[["app-course-form"]],inputs:{course:"course"},outputs:{save:"save"},features:[$],decls:18,vars:7,consts:[[3,"ngSubmit","formGroup"],["type","hidden","formControlName","id"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","title",1,"form-control"],[1,"invalid-feedback"],["rows","3","formControlName","description",1,"form-control"],["type","submit",1,"btn","btn-success","me-2"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(e,o){if(e&1&&(n(0,"form",0),d("ngSubmit",function(){return o.onSubmit()}),b(1,"input",1),n(2,"div",2)(3,"label",3),s(4,"T\xEDtulo"),r(),b(5,"input",4),n(6,"div",5),s(7),r()(),n(8,"div",2)(9,"label",3),s(10,"Descripci\xF3n"),r(),b(11,"textarea",6),n(12,"div",5),s(13),r()(),n(14,"button",7),s(15,"Guardar"),r(),n(16,"button",8),d("click",function(){return o.onReset()}),s(17,"Cancelar"),r()()),e&2){let a,c;m("formGroup",o.courseForm),l(5),I("is-invalid",((a=o.courseForm.get("title"))==null?null:a.invalid)&&((a=o.courseForm.get("title"))==null?null:a.touched)),l(2),_(o.getErrorMessage("title")),l(4),I("is-invalid",((c=o.courseForm.get("description"))==null?null:c.invalid)&&((c=o.courseForm.get("description"))==null?null:c.touched)),l(2),_(o.getErrorMessage("description"))}},dependencies:[v,Y,K,U,z,J,Q,W],styles:["[_nghost-%COMP%]{display:block;padding:1rem}"]})};function ye(i,t){if(i&1){let e=T();n(0,"div",7)(1,"div",8)(2,"h5",9),s(3),r(),n(4,"app-course-form",10),d("save",function(a){f(e);let c=u(2);return C(c.saveCourse(a))}),r()()()}if(i&2){let e=u(2);l(3),_(e.courseToEdit.id===0?"A\xF1adir curso":"Editar curso"),l(),m("course",e.courseToEdit)}}function we(i,t){if(i&1){let e=T();n(0,"div",1)(1,"div",2)(2,"h4",3),s(3,"Listado de cursos"),r(),n(4,"button",4),d("click",function(){f(e);let a=u();return C(a.newCourse())}),s(5," A\xF1adir curso "),r()(),n(6,"app-courses-table",5),d("editar",function(a){f(e);let c=u();return C(c.editCourse(a))})("eliminar",function(a){f(e);let c=u();return C(c.deleteCourse(a))}),r(),p(7,ye,5,2,"div",6),r()}if(i&2){let e=t.ngIf,o=u();l(4),m("disabled",!e.canEdit),l(2),m("courses",e.courses)("canEdit",e.canEdit),l(),m("ngIf",o.courseToEdit)}}var pe=class i{constructor(t,e){this.coursesService=t;this.auth=e}refresh$=new V(void 0);vm$;courseToEdit=null;ngOnInit(){this.vm$=N([this.refresh$.pipe(A(()=>this.coursesService.getCourses())),this.auth.currentUser$]).pipe(P(([t,e])=>({courses:t,canEdit:!!e&&e.role==="admin"})),R(1))}newCourse(){this.courseToEdit={id:0,title:"",description:""}}editCourse(t){this.courseToEdit=y({},t)}async saveCourse(t){t.id===0?await w(this.coursesService.addCourse({title:t.title,description:t.description})):await w(this.coursesService.updateCourse(t)),this.courseToEdit=null,this.refresh$.next()}async deleteCourse(t){await w(this.coursesService.deleteCourse(t.id)),this.refresh$.next()}static \u0275fac=function(e){return new(e||i)(h(me),h(L))};static \u0275cmp=g({type:i,selectors:[["app-courses"]],decls:2,vars:3,consts:[["class","container mt-4",4,"ngIf"],[1,"container","mt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0"],[1,"btn","btn-primary",3,"click","disabled"],[3,"editar","eliminar","courses","canEdit"],["class","card mt-4",4,"ngIf"],[1,"card","mt-4"],[1,"card-body"],[1,"card-title"],[3,"save","course"]],template:function(e,o){e&1&&(p(0,we,8,4,"div",0),H(1,"async")),e&2&&m("ngIf",j(1,1,o.vm$))},dependencies:[v,M,F,D,q],encapsulation:2,changeDetection:0})};export{pe as CoursesComponent};
